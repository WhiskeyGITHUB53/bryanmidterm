{"version":3,"file":"vuetify.mjs","names":["ref","watch","consoleError","consoleWarn","getObjectValueByPath","useProxiedModel","en","LANG_PREFIX","replace","str","params","match","index","String","createTranslateFunction","current","fallback","messages","key","startsWith","shortKey","currentLocale","value","fallbackLocale","createNumberFunction","options","numberFormat","Intl","NumberFormat","format","useProvided","props","prop","provided","internal","v","createProvideFunction","state","name","t","n","provide","createVuetifyAdapter","locale"],"sources":["../../../src/locale/adapters/vuetify.ts"],"sourcesContent":["import { ref, watch } from 'vue'\nimport { consoleError, consoleWarn, getObjectValueByPath } from '@/util'\nimport { useProxiedModel } from '@/composables/proxiedModel'\nimport en from '@/locale/en'\n\nimport type { Ref } from 'vue'\nimport type { LocaleInstance, LocaleMessages, LocaleOptions } from '@/composables/locale'\n\nconst LANG_PREFIX = '$vuetify.'\n\nconst replace = (str: string, params: unknown[]) => {\n  return str.replace(/\\{(\\d+)\\}/g, (match: string, index: string) => {\n    return String(params[+index])\n  })\n}\n\nconst createTranslateFunction = (\n  current: Ref<string>,\n  fallback: Ref<string>,\n  messages: Ref<LocaleMessages>,\n) => {\n  return (key: string, ...params: unknown[]) => {\n    if (!key.startsWith(LANG_PREFIX)) {\n      return replace(key, params)\n    }\n\n    const shortKey = key.replace(LANG_PREFIX, '')\n    const currentLocale = current.value && messages.value[current.value]\n    const fallbackLocale = fallback.value && messages.value[fallback.value]\n\n    let str: string = getObjectValueByPath(currentLocale, shortKey, null)\n\n    if (!str) {\n      consoleWarn(`Translation key \"${key}\" not found in \"${current.value}\", trying fallback locale`)\n      str = getObjectValueByPath(fallbackLocale, shortKey, null)\n    }\n\n    if (!str) {\n      consoleError(`Translation key \"${key}\" not found in fallback`)\n      str = key\n    }\n\n    if (typeof str !== 'string') {\n      consoleError(`Translation key \"${key}\" has a non-string value`)\n      str = key\n    }\n\n    return replace(str, params)\n  }\n}\n\nfunction createNumberFunction (current: Ref<string>, fallback: Ref<string>) {\n  return (value: number, options?: Intl.NumberFormatOptions) => {\n    const numberFormat = new Intl.NumberFormat([current.value, fallback.value], options)\n\n    return numberFormat.format(value)\n  }\n}\n\nfunction useProvided <T> (props: any, prop: string, provided: Ref<T>) {\n  const internal = useProxiedModel(props, prop, props[prop] ?? provided.value)\n\n  // TODO: Remove when defaultValue works\n  internal.value = props[prop] ?? provided.value\n\n  watch(provided, v => {\n    if (props[prop] == null) {\n      internal.value = provided.value\n    }\n  })\n\n  return internal as Ref<T>\n}\n\nfunction createProvideFunction (state: { current: Ref<string>, fallback: Ref<string>, messages: Ref<LocaleMessages> }) {\n  return (props: LocaleOptions): LocaleInstance => {\n    const current = useProvided(props, 'locale', state.current)\n    const fallback = useProvided(props, 'fallback', state.fallback)\n    const messages = useProvided(props, 'messages', state.messages)\n\n    return {\n      name: 'vuetify',\n      current,\n      fallback,\n      messages,\n      t: createTranslateFunction(current, fallback, messages),\n      n: createNumberFunction(current, fallback),\n      provide: createProvideFunction({ current, fallback, messages }),\n    }\n  }\n}\n\nexport function createVuetifyAdapter (options?: LocaleOptions): LocaleInstance {\n  const current = ref(options?.locale ?? 'en')\n  const fallback = ref(options?.fallback ?? 'en')\n  const messages = ref(options?.messages ?? { en })\n\n  return {\n    name: 'vuetify',\n    current,\n    fallback,\n    messages,\n    t: createTranslateFunction(current, fallback, messages),\n    n: createNumberFunction(current, fallback),\n    provide: createProvideFunction({ current, fallback, messages }),\n  }\n}\n"],"mappings":"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"}